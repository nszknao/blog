---
title: "ç”ŸæˆAIã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆã™ã‚‹ç‰©ç†ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ã€ŒGenesisã€"
emoji: "âš›ï¸"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["Python", "Genesis"]
published: false
---

# ã¯ã˜ã‚ã«

å…ˆæ—¥ç™ºè¡¨ã•ã‚ŒãŸç‰©ç† AI ã‚¨ãƒ³ã‚¸ãƒ³ã€ŒGenesisã€ãŒè©±é¡Œã«ãªã£ã¦ã„ãŸã®ã§ã€ãã®å°å…¥æ–¹æ³•ã‚„åŸºæœ¬çš„ãªä½¿ã„æ–¹ã‚’è§£èª¬ã—ã¾ã™ã€‚

https://x.com/_philschmid/status/1869639246434246966

# Genesis ã¨ã¯

NVIDIA ã‚„ã‚«ãƒ¼ãƒã‚®ãƒ¼ãƒ¡ãƒ­ãƒ³å¤§å­¦ãªã©ã®ç ”ç©¶è€…ãŸã¡ã«ã‚ˆã£ã¦é–‹ç™ºã•ã‚ŒãŸã€æ±ç”¨ãƒ­ãƒœãƒƒãƒˆãƒ»ãƒ•ã‚£ã‚¸ã‚«ãƒ« AI ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãŸã‚ã«è¨­è¨ˆã•ã‚ŒãŸç‰©ç†ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã§ã™ã€‚
https://genesis-embodied-ai.github.io/

è‡ªç„¶è¨€èªã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆã¨ã„ã£ãŸ AI æ©Ÿèƒ½ã‚’ãƒã‚¤ãƒ†ã‚£ãƒ–ã§ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã‚‹ãªã©ã€ä»–ã®ç‰©ç†ã‚¨ãƒ³ã‚¸ãƒ³ã«ã¯ãªã„ç‰¹å¾´ã‚’æŒã£ã¦ã„ã¾ã™ã€‚

- ğŸ 100% Python
- ğŸ‘¶ ç°¡å˜ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ï¼†ã‚·ãƒ³ãƒ—ãƒ«ãª API è¨­è¨ˆ
- ğŸš€ ä¸¦åˆ—åŒ–ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚‹é«˜é€ŸåŒ–
- ğŸ’¥ å¤šæ§˜ãªç‰©ç†ç¾è±¡ã‚’æ‰±ã†çµ±ä¸€ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- ğŸ“¸ ãƒ•ã‚©ãƒˆãƒªã‚¢ãƒ«ãªãƒ¬ã‚¤ãƒˆãƒ¬ãƒ¼ã‚·ãƒ³ã‚°ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°
- ğŸ“ å¾®åˆ†å¯èƒ½ãªã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿
- â˜ğŸ» ç‰©ç†çš„ã«æ­£ç¢ºã§å¾®åˆ†å¯èƒ½ãªè§¦è¦šã‚»ãƒ³ã‚µãƒ¼
- ğŸŒŒ è‡ªç„¶è¨€èªã§ã•ã¾ã–ã¾ãªãƒ‡ãƒ¼ã‚¿ã‚’ç”Ÿæˆå¯èƒ½

# ç’°å¢ƒæ§‹ç¯‰

ç§ãŒè©¦ã—ãŸç’°å¢ƒã¯ã“ã¡ã‚‰ã§ã™ã€‚

- Apple M1 (macOS Sequoia 15.2)
- Python 3.11
- Miniconda ãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿
  - uv ã® Python çµŒç”±ã ã¨ OpenGL ã®ã‚¨ãƒ©ãƒ¼ã§ãƒ“ãƒ¥ãƒ¼ãƒ¯ãŒèµ·å‹•ã—ãªã„ä¸å…·åˆãŒã‚ã‚Šã¾ã™ [Issue#11](https://github.com/Genesis-Embodied-AI/Genesis/issues/11)

## ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

:::details uv ã§è©¦ã—ãŸã‘ã©å¤±æ•—ã—ãŸå›³

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®[Getting Started](https://genesis-world.readthedocs.io/en/latest/#getting-started)ã«æ²¿ã£ã¦é€²ã‚ã¾ã™ã€‚

```bash
uv add genesis-world
```

PyTorch ãŒç„¡ã„å ´åˆã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```bash
uv add torch
```

å‹•ä½œç¢ºèªã®ãŸã‚ã€[ğŸ‘‹ğŸ» Hello, Genesis](https://genesis-world.readthedocs.io/en/latest/user_guide/getting_started/hello_genesis.html)ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```python:hello.py
import genesis as gs
gs.init(backend=gs.cpu)

scene = gs.Scene(show_viewer=True)
plane = scene.add_entity(gs.morphs.Plane())
franka = scene.add_entity(
    gs.morphs.MJCF(file='xml/franka_emika_panda/panda.xml'),
)

scene.build()

for i in range(1000):
    scene.step()
```

```bash
uv run python hello.py
```

å®Ÿè¡Œã¯å®Œäº†ã—ãŸã®ã§ã™ãŒã€ä»¥ä¸‹ã®è­¦å‘Šã¨ã¨ã‚‚ã«ãƒ“ãƒ¥ãƒ¼ã‚¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚

```
[Genesis] [17:00:00] [WARNING] Non-linux system detected. In order to use the interactive viewer, you need to manually run simulation in a separate thread and then start viewer. See `examples/render_on_macos.py`.
```

Linux ä»¥å¤–ã®ãƒã‚·ãƒ³ã§ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¢ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€æ‰‹å‹•ã§åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã€ãƒ“ãƒ¥ãƒ¼ã‚¢ã‚’èµ·å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

è­¦å‘Šã«ã‚ã‚‹é€šã‚Šã€[examples/render_on_macos.py](https://github.com/Genesis-Embodied-AI/Genesis/blob/main/examples/render_on_macos.py) ã‚’ä»£ã‚ã‚Šã«å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```bash
uv run python render_on_macos.py --vis
```

[#11](https://github.com/Genesis-Embodied-AI/Genesis/issues/11)ã®ãƒã‚°ã‚’è¸ã‚“ã§ã—ã¾ã„ã€è§£æ±ºã«æ™‚é–“ãŒã‹ã‹ã‚Šãã†ãªã®ã§ Miniconda ã§ç’°å¢ƒã‚’ä½œã‚Šç›´ã—ã¦ã¿ã¾ã™ã€‚

:::

å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®[Getting Started](https://genesis-world.readthedocs.io/en/latest/#getting-started)ã®æ‰‹é †ã¯ã‚·ãƒ³ãƒ—ãƒ«ãªã®ã§ã™ãŒã€ç§ã®ç’°å¢ƒã§ã¯ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã®é †ç•ªã«ã‚ˆã£ã¦å‹•ã‹ãªã„ã“ã¨ãŒã‚ã£ãŸã®ã§æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚[Issue#61](https://github.com/Genesis-Embodied-AI/Genesis/issues/61)ã‚‚å ±å‘Šã•ã‚Œã¦ã¾ã—ãŸã€‚

PyTorch ãŒç„¡ã„å ´åˆã¯å…ˆã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```bash
conda install pytorch::pytorch torchvision torchaudio -c pytorch
```

genesis-world ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã€‚

```bash
pip install genesis-world
```

å‹•ä½œç¢ºèªã®ãŸã‚ã€[ğŸ‘‹ğŸ» Hello, Genesis](https://genesis-world.readthedocs.io/en/latest/user_guide/getting_started/hello_genesis.html)ã®ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```python:hello.py
import genesis as gs
gs.init(backend=gs.cpu)

scene = gs.Scene(show_viewer=True)
plane = scene.add_entity(gs.morphs.Plane())
franka = scene.add_entity(
    gs.morphs.MJCF(file='xml/franka_emika_panda/panda.xml'),
)

scene.build()

for i in range(1000):
    scene.step()
```

```bash
python hello.py
```

å®Ÿè¡Œã¯å®Œäº†ã—ãŸã®ã§ã™ãŒã€ä»¥ä¸‹ã®è­¦å‘Šã¨ã¨ã‚‚ã«ãƒ“ãƒ¥ãƒ¼ã‚¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã§ã—ãŸã€‚

```
[Genesis] [17:00:00] [WARNING] Non-linux system detected. In order to use the interactive viewer, you need to manually run simulation in a separate thread and then start viewer. See `examples/render_on_macos.py`.
```

Linux ä»¥å¤–ã®ãƒã‚·ãƒ³ã§ã‚¤ãƒ³ã‚¿ãƒ©ã‚¯ãƒ†ã‚£ãƒ–ãƒ“ãƒ¥ãƒ¼ã‚¢ã‚’ä½¿ç”¨ã™ã‚‹ã«ã¯ã€æ‰‹å‹•ã§åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã€ãƒ“ãƒ¥ãƒ¼ã‚¢ã‚’èµ·å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã‚ˆã†ã§ã™ã€‚

è­¦å‘Šã«ã‚ã‚‹é€šã‚Šã€[examples/render_on_macos.py](https://github.com/Genesis-Embodied-AI/Genesis/blob/main/examples/render_on_macos.py) ã‚’ä»£ã‚ã‚Šã«å®Ÿè¡Œã—ã¦ã¿ã¾ã™ã€‚

```bash
python render_on_macos.py --vis
```

æ­£å¸¸ã«ãƒ“ãƒ¥ãƒ¼ãƒ¯ãŒç«‹ã¡ä¸ŠãŒã‚Šã€ã‚¢ãƒ¼ãƒ ãŒåºŠã«è‡ªç”±è½ä¸‹ã™ã‚‹æ§˜å­ãŒç¢ºèªã§ãã¾ã—ãŸã€‚

![](/images/genesis-simulator-tutorial/ca54f8d2-d086-4fc0-a911-ee4fda74a8fc.webp)

# åŸºæœ¬çš„ãªä½¿ã„æ–¹

## åˆæœŸåŒ–

æœ€åˆã®ã‚¹ãƒ†ãƒƒãƒ—ã§ã€genesis ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦åˆæœŸåŒ–ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

```python
import genesis as gs
gs.init(backend=gs.cpu, precision="32")
```

- **ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ãƒ‡ãƒã‚¤ã‚¹**: ã‚¯ãƒ­ã‚¹ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã«å¯¾å¿œã—ã¦ã„ã¦ã€ã“ã“ã§ã¯`gs.cpu`ã‚’æŒ‡å®šã—ã¦ã„ã¾ã™ãŒã€`gs.cuda`ãªã©ã®ä»–ã®ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚
- **ç²¾åº¦**: ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ f32 ç²¾åº¦ã§ã™ãŒã€ã‚ˆã‚Šé«˜ã„ç²¾åº¦ãŒå¿…è¦ãªå ´åˆã¯`"64"`ã‚’æŒ‡å®šã™ã‚‹ã“ã¨ã§ f64 ç²¾åº¦ã«åˆ‡ã‚Šæ›¿ãˆã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

## ã‚·ãƒ¼ãƒ³ã®ä½œæˆ

ã™ã¹ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€ãƒ­ãƒœãƒƒãƒˆã€ã‚«ãƒ¡ãƒ©ãªã©ã¯ã‚·ãƒ¼ãƒ³ã«é…ç½®ã•ã‚Œã¾ã™ã€‚

```python
scene = gs.Scene(
    sim_options=gs.options.SimOptions(
        dt=0.01,
        gravity=(0, 0, -10.0),
    ),
    show_viewer=True,
    viewer_options=gs.options.ViewerOptions(
        camera_pos=(3.5, 0.0, 2.5),
        camera_lookat=(0.0, 0.0, 0.5),
        camera_fov=40,
    ),
)
```

ã“ã®ä¾‹ã§ã¯ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ dt ã‚’å„ã‚¹ãƒ†ãƒƒãƒ—ã§ 0.01s ã«è¨­å®šã—ã€é‡åŠ›ã‚’è¨­å®šã—ã€ãƒ“ãƒ¥ãƒ¼ãƒ¯ã®åˆæœŸã‚«ãƒ¡ãƒ©ãƒãƒ¼ã‚ºã‚’è¨­å®šã—ã¾ã™ã€‚

## ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã®è¿½åŠ 

Genesis ã§ã¯ã€ã™ã¹ã¦ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ãƒ­ãƒœãƒƒãƒˆã¯ Entity ã¨ã—ã¦è¡¨ã•ã‚Œã¾ã™ã€‚ ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã§è¨­è¨ˆã•ã‚Œã¦ã„ã‚‹ãŸã‚ã€ãƒãƒ³ãƒ‰ãƒ«ã‚„å‰²ã‚Šå½“ã¦ã‚‰ã‚ŒãŸã‚°ãƒ­ãƒ¼ãƒãƒ« ID ã‚’ä½¿ç”¨ã™ã‚‹ä»£ã‚ã‚Šã«ã€ãƒ¡ã‚½ãƒƒãƒ‰ã‚’é€šã˜ã¦ç›´æ¥ã“ã‚Œã‚‰ã® Entity ã‚’æ“ä½œã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

```python
plane = scene.add_entity(gs.morphs.Plane())
franka = scene.add_entity(
    gs.morphs.MJCF(file='xml/franka_emika_panda/panda.xml'),
)
```

`add_entity`ã®ç¬¬ä¸€å¼•æ•°ã¯ Morph å‹ã§ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ã‚¿ã‚¤ãƒ—ã‚’æŒã¡ã¾ã™ã€‚

- `gs.morphs.Box`: ãƒœãƒƒã‚¯ã‚¹
- `gs.morphs.Sphere`: çƒ
- `gs.morphs.Cylinder`: ã‚·ãƒªãƒ³ãƒ€ãƒ¼
- `gs.morphs.Plane`: å¹³é¢

![](/images/genesis-simulator-tutorial/b1b1cebc-bf64-4118-8ebf-d659451eb0b2.webp)

ã¾ãŸã€ä»–ã®ãƒ„ãƒ¼ãƒ«ã§ä½œæˆã—ãŸ 3D ãƒ¢ãƒ‡ãƒ«ã‚’èª­ã¿è¾¼ã‚€ã“ã¨ã‚‚ã§ãã¾ã™ã€‚ç¾åœ¨ã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ãƒ•ã‚©ãƒ¼ãƒãƒƒãƒˆã¯ã“ã¡ã‚‰ã§ã™ã€‚

- `gs.morphs.MJCF`: MuJoCo XML ãƒ•ã‚¡ã‚¤ãƒ«
- `gs.morphs.URDF`: URDF(Unified Robotics Description Format) ãƒ•ã‚¡ã‚¤ãƒ«
- `gs.morphs.Mesh`: ãƒ¡ãƒƒã‚·ãƒ¥ã‚¢ã‚»ãƒƒãƒˆï¼ˆ\*.obj, \*.ply, \*.stl, \*.glb, \*.gltfï¼‰

## ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã®å®Ÿè¡Œ

ã“ã‚Œã¾ã§ã«è¿½åŠ ã—ãŸã‚¢ã‚»ãƒƒãƒˆã‚’ãƒ“ãƒ«ãƒ‰ã—ã€ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```python
scene.build()
for i in range(1000):
    scene.step()
```

ã¾ãš`scene.build()`ã‚’å‘¼ã³å‡ºã—ã¦ã‚·ãƒ¼ãƒ³ã‚’ãƒ“ãƒ«ãƒ‰ã™ã‚‹å¿…è¦ãŒã‚ã‚‹ã“ã¨ã«æ³¨æ„ãŒå¿…è¦ã§ã™ã€‚
ã“ã‚Œã¯ã€genesis ãŒå®Ÿè¡Œã”ã¨ã« GPU ã‚«ãƒ¼ãƒãƒ«ã‚’ãã®å ´ã§ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹ JIT ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’æ¡ç”¨ã—ã¦ã„ã¦ã€ãƒ—ãƒ­ã‚»ã‚¹ã‚’é–‹å§‹ã™ã‚‹æ˜ç¤ºçš„ãªã‚¹ãƒ†ãƒƒãƒ—ãŒå¿…è¦ãªãŸã‚ã§ã™ã€‚

# æ³¨æ„ç‚¹ã¨ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

# ã¾ã¨ã‚

ãã‚Œã§ã¯ã¾ãŸãŠä¼šã„ã—ã¾ã—ã‚‡ã†ï¼
